<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=480">
    <title>81 Place</title>
    <link rel="stylesheet" type="text/css" href="style.css" />
  </head>
  <body>
    <script type="module" src="main.js"></script>
    <div id="game_area"></div>
    <div class="rule_tit" id="rule_tit_but"></div>
    <div class="rule_book" id="rule_book_div">
      <p>　ハチワン・プレース は基本的にただの <a href="https://ja.wikipedia.org/wiki/%E6%95%B0%E7%8B%AC" target="_blank" rel="noopener noreferrer">ナンプレ（数独）</a> で、START をクリックするとゲームが始まります。ただし、このソフトウェアはプレイヤーのパズルの腕前を評価します。</p>
      <p>　———目指せ１２万点。</p>
      <p>　あなたの頭脳の優秀さは次のように計算されます：</p>
      <p style="text-align:center;font-weight:bold">スコア ＝ 基礎点 ＋ タイムボーナス</p>
      <p style="text-align:center;font-weight:bold">タイムボーナス ＝ 基礎点 − ( クリア時間 ÷ 50 )</p>
      <p>　クリア時間はナンプレを解くのに使った時間で、単位はミリ秒です。ただし、時間をかけすぎて負の値になった場合ボーナスは０点です。</p>
      <h4>■ 基礎点とは</h4>
      <p>　あなたにはゲームの最初に８１手番の「ターン数」が与えられ、パズルに数字を記入するたびにターン数が減ります。</p>
      </p>　そして基礎点は、</p>
      <p style="text-align:center;font-weight:bold">pt ＝ ターン数 × 書き込んだ数字の三角数</p>
      <p>のように計算した pt の合計点です。</p>
      <p>　三角数とは「 n × (n + 1) ÷ 2 」で計算される値です。</p>
      <table class="hyo">
        <th>
          <tr>
            <td>書き込んだ数字</td>
            <td>１</td><td>２</td><td>３</td>
            <td>４</td><td>５</td><td>６</td>
            <td>７</td><td>８</td><td>９</td>
          </tr>
        </th>
        <tr>
          <td>三角数</td>
          <td>1</td><td>3</td><td>6</td>
          <td>10</td><td>15</td><td>21</td>
          <td>28</td><td>36</td><td>45</td>
        </tr>
      </table>
      <p>　例えば最初に書き込んだ数字が９ならターン数は８１なので、</p>
      <p style="text-align:center;font-weight:bold">(9 × (9 ＋ 1) ÷ 2) × 81 ＝ 45 × 81 ＝ 3,645点</p>
      <p>になります。</p>
      <p>　ところが最初に見つけた数字が２なら「(2 × (2 ＋ 1) ÷ 2) × 81 ＝ 3 × 81 ＝ 243点」にしかなりません。<b>１５倍</b>も違います。</p>
      <p>　また、あなたが２０ターン目に９を見つけてもそのときのターン数は 81 − 20 ＝ 61 ですから「(9 × (9 ＋ 1) ÷ 2) × <b>61</b> ＝ 45 × 61 ＝ 2,745点」に減ります。</p>
      <p>　数独ソフトは世に数多ありますが、ただのナンプレに <b>なるべく早く９や８などの大きな数字を見つける</b> という要素を加えてみたのがこのソフトの主張です。</p>
      <p>　なお、「書き込んだ数字」は正解の数字でなければなりません。不正解の場合はターン数だけが減少し、そのターンの得点は０点になってしまいます。<p>
      <p>　また、同じマス目に何度も記入した場合は最後に記入した数字だけが得点します。ターン数は書き込むたびに減って行くので一発で正解するほうが得だということです。</p>
      <p>　基礎点の理論的な最大値は 87,615点 ですが、これはヒント無しの８１マスすべてを埋めたときの数です。ヒントでマス目が消費される以上、現実には８万点弱が限界でしょう。</p>
      <p>　——約８万の基礎点とタイムボーナスを稼ぎ、<b>スコア１２万点超え</b> を目指してみてください。</p>
      <h4>■ ゲーム画面の説明</h4>
      <p>　ゲーム画面の右上に表示された「START」を押すとゲームが始まります。ただし、このページを開いた直後には表示されていないかもしれません。</p>
      <p>　問題画面は単純なアルゴリズムによって作られていて、原理上、仮定法を使わずに解けるし、解が唯一の問題を作ります。しかし計算が遅く、古いマシンを使う場合、最悪で３０秒ほど待たせるでしょう。また、正しく動作させるために少なくとも 2020年 以降のブラウザが必要になります。</p>
      <p>　問題の難易度は運次第ですが、後述するIDの末尾２ケタが多いほど簡単、少ないほど難しいと考えられます。</p>
      <h4>■ 書き込む数字の選択</h4>
      <p>　ゲームがスタートした後は、問題画面下部のリストから入力したい数字を選びます。クリックするかその数字のキーボードを押すと選択できます。a キーを入力すると数字がひとつ増え、d キーで減らすこともできます。入力したい場所をクリックすることで選んだナンバーを記入できます。正解かはともかくある数字が９個記入されたら選択肢は暗くなります。</p>
      <p>　記入した瞬間、その数字が<font color="red">赤く</font>表示された時は、<b>同じ数字が今この瞬間に入力位置のタテ・ヨコか部屋に存在する</b> という警告です。画面に他の矛盾があっても表示されるのはその瞬間の矛盾だけで、次の入力があれば警告はすべて消えます。まだ矛盾が残っていても表示されません。</p>
      <p>　記入した数字の色が<font color="blue">青い</font>場合は瞬間的な矛盾が無いことを意味します。この表示は <b>今は</b> 矛盾していないというだけで、問題の最後まで無矛盾であることを保証するものではありません。</p>
      <p>　⌫ は消しゴムで、書き損じたマスに空白を入力します。空白でも書き込めばターン数を消費します ：）</p>
      <p>　すべてのマス目が数字で埋められ、しかもすべてが正解であれば「おめでとう」というメッセージとともに得点が通知されます。</p>
      <h4>■ 一時停止</h4>
      <p>　問題画面のタイトル部分の「８１」は残りターン数を表していますが、ゲーム中にこの部分をクリックすると表示が PAUSE に変わり、一時停止できます。</p>
      <p>　ゲームをクリアした後に新しい問題を始めたいときもタイトル部分（その時は得点が表示されています）をクリックしてください。内部で問題の生成が完了していれば「次を遊ぶ？」と聞かれます。</p>
      <h4>■ 問題を保存する</h4>
      <p>　ゲームが開始されると「START」はゲームIDに変化します。これは同じ盤面を表示するための鍵で、ゲーム中にID部分をクリックするとクリップボードにコピーできます。</p>
      <p>　IDはURLになっているので、パズルを解いている最中にどこが間違っているのかわからないような矛盾に出くわしたらコピーして貼り付けリロードするのも手でしょう。STARTを押せばまっさらな状態から同じ問題を再開できます。URLを友人に送り得点勝負を挑むこともできます。</p>
      <p>　URLではなくIDのみをメモした場合は次のフォームに入力してください。初期表示はサンプルのIDです。</p>
      <form action="/" style="text-align:center">
        <input type="text" value="N658CE20P29" name="id">
        <input type="submit" value="Play">
        <p style="font-size: 0.8em">※空白等を入れないよう注意してください。</p>
      </form>
      <p>　URLについたIDを無くし、素の状態でこのページを開きたいときは <a href="/">こちら</a> をクリックしてください。</p>
      <p style="text-align:center;font-weight:bold"><a href="https://github.com/hoeg1/81place" target="_blank" rel="noopener noreferrer">source code</a></p>
    </div>
  </body>
</html>

