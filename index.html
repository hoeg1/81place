<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=480">
    <title>81 Place</title>
    <link rel="stylesheet" type="text/css" href="style.css" />
  </head>
  <body>
    <script type="module" src="main.js"></script>
    <div id="game_area"></div>
    <div id="mokuhyo"></div>
    <div id="hi_score" class="hi_score"></div>
    <div class="rule_tit" id="rule_tit_but"></div>
    <div class="rule_book" id="rule_book_div">
      <p>　ハチワン・プレース は基本的にただの <a href="https://ja.wikipedia.org/wiki/%E6%95%B0%E7%8B%AC" target="_blank" rel="noopener noreferrer">ナンプレ（数独）</a> で、START をクリックするとゲームが始まります。ただし、このソフトウェアはプレイヤーの腕前を評価します。</p>
      <p>　——目指せ１０万点。</p>
      <p>　あなたの頭脳の優秀さは次のように計算されます：</p>
      <p style="text-align:center;font-weight:bold">スコア ＝ 基礎点 ＋ タイムボーナス</p>
      <p style="text-align:center;font-weight:bold">タイムボーナス ＝ 基礎点 − ( クリア時間 ÷ 50 )</p>
      <p>　クリア時間はナンプレを解くのに使った時間で、単位はミリ秒です。</p>
      <p>　要するにタイム・ボーナスは基礎点から <b>１秒あたり 20 点引いた数</b> で、時間をかけすぎて負の値になった場合ボーナスは無しになり基礎点のみがスコアになります。</p>
      <p>　後述の通り基礎点には限界があるので、概ね４５分（厳密には１時間１３分）を越えたらボーナスは無しと考えてください。</p>
      <h4>■ 基礎点とは</h4>
      <p>　あなたにはゲームの最初に <b>８１手のターン数</b> が与えられ、画面に数字を記入するたびターン数が減ります。</p>
      </p>　そして基礎点は、</p>
      <p style="text-align:center;font-weight:bold">pt ＝ ターン数 × 書き込んだ数字の三角数</p>
      <p>のように計算した pt の合計点です。</p>
      <p>　三角数とは「 n × (n + 1) ÷ 2 」で計算される値です。</p>
      <table class="hyo">
        <tr>
          <td>書き込んだ数字</td>
          <td>１</td><td>２</td><td>３</td>
          <td>４</td><td>５</td><td>６</td>
          <td>７</td><td>８</td><td>９</td>
        </tr>
        <tr>
          <td>三角数</td>
          <td>1</td><td>3</td><td>6</td>
          <td>10</td><td>15</td><td>21</td>
          <td>28</td><td>36</td><td>45</td>
        </tr>
      </table>
      <p>　例えば最初に書き込んだ数字が「９」なら、ターン数は８１なので、</p>
      <p style="text-align:center;font-weight:bold">(9 × (9 ＋ 1) ÷ 2) × 81 ＝ 45 × 81 ＝ 3,645点</p>
      <p>になりますが、最初に見つけた数字が「２」なら「(2 × (2 ＋ 1) ÷ 2) × 81 ＝ 3 × 81 ＝ 243点」にしかなりません。<b>１５倍</b>も違います。</p>
      <p>　また、あなたが２０ターン目に９を見つけてもそのときのターン数は 81 − 20 ＝ 61 ですから「(9 × (9 ＋ 1) ÷ 2) × <b>61</b> ＝ 45 × 61 ＝ 2,745点」に減ります。</p>
      <p>　数独アプリは世に数多ありますが、ただのナンプレに <b>なるべく早く９や８などの大きな数字を見つける</b> という要素を加えてみたのがこのゲームの主張です。</p>
      <p>　なお「書き込んだ数字」は正解の数字でなければなりません。不正解の場合はターン数だけが減少し、そのターンの得点は０点になってしまいます。しかも正解か否かは表示されません。<p>
      <p>　同じマス目に何度も記入した場合は最後に記入した数字だけが得点します。ターン数は書き込むたびに減るので、一発で正解するほうが得だということです。</p>
      <h4>■ ゲームの目標点</h4>
      <p>　基礎点の理論的な最大値は 87,615点 ですが、これはヒント無しの８１マスすべてを埋めたときの数です。ヒントでマス目が消費される以上、現実には７万点程度が限界でしょう。</p>
      <p>　——約７万の基礎点とタイム・ボーナスを稼ぎ、まずは <b>スコア１０万点</b> を目指してください。</p>
      <p>　達成できたら目標点は１万ずつ増え、<b>最大で１５万点</b> になりますが、１２万点に大きな壁があります。</p>
      <p>　１２万点を得るには基礎点６万５千点程度が必要で、しかも多くて１５分以内に問題を解かなければいけません。</p>
      <p>　あなたは１２万点を超えられますか……？</p>
      <p>　ちなみに作者の最高得点は一切のイカサマ無しで１３万３千点です。id: S8A54811 で奇跡的に７万強の基礎点が得られ、達成できました。</p>
      <p>　<small>ルール上は１４万点以上がありうるけど、イカサマ無しだと不可能じゃないかな？</small></p>
      <h4>■ ゲーム画面の説明</h4>
      <p>　ゲーム画面の右上に表示された「START」を押すとゲームが始まります。</p>
      <p>　問題画面は単純なアルゴリズムによって作られていて、解が唯一の問題を作ります。</p>
      <p>　問題は常に仮定法を使わずに解けます。「１〜９の数のうち、今、このマスに入ることができるのはｎだけ」という考え方を徹底してください。それだけで必ず解けるように作られています。</p>
      <h4>■ 書き込む数字の選択</h4>
      <p>　ゲームがスタートした後は、問題画面下部のリストから入力したい数字を選んでください。</p>
      <p>　その数字のキーボードを押すことでも選択でき、９は特別に Q でも選択できます。A キーを入力すると数字がひとつ増え、D キーで減らすことができます。</p>
      <p>　入力したい場所をクリックすることで選んだ数を記入でき、画面に累計９個記入された選択肢は暗くなります。</p>
      <p>　⌫ は消しゴムで、０またはスペースで選択できます。他の数字と矛盾する記入をするとその数字が赤くなるので、間違えたときは消すか上書きしましょう。ただし、空白でも書き込めばターン数を消費します ：）</p>
      <p>　選択中の数字を書き込むと矛盾するマスは色がついて強調されます。</p>
      <h4>■ タイマの一時停止</h4>
      <p>　問題画面の時間部分をクリックすると一時停止できます。再びクリックすると再開します。</p>
      <h4>■ 問題を保存する</h4>
      <p>　ゲームが開始されると「START」はゲームIDに変化します。これは同じ盤面を表示するための鍵で、ゲーム中にID部分をクリックするとクリップボードに盤面を再現するためのURLがコピーされます。</p>
      <p>　URLではなくIDのみをメモした場合は次のフォームに入力してください。初期表示はサンプルのIDです。</p>
      <form action="/" style="text-align:center">
        <input type="text" value="S8A54811" name="id">
        <input type="submit" value="Play">
        <p style="font-size: 0.8em">※空白等を入れないよう注意してください。</p>
      </form>
      <h4>■ あり得る解の表示</h4>
      <p>　初期状態で「81 PLACE」と表示されているタイトル部分は手番のたびに残りターン数を表しますが、プレイ中にクリックすると <b>５手と引き換えに答えをひとつ表示</b> します。</p>
      <p>　解答は現在の状態に基づいて算出されるので、間違った数字を書き込んだ状態で開くと「答えがない」と返されることがあります。この機能は正解を示すものではなく、今の画面がすべて正しければ導き出せる答えを示すだけだということです。</p>
      <p>　ともあれこれは強力なチート機能ですが、使えば <b>５ターン</b> 消費され以降の基礎点が激減することを忘れてはいけません。１３万点以上を目指すなら自分の頭脳を頼るべきです：）</p>
      <h4>■ ゲームのクリア</h4>
      <p>　すべてのマス目が数字で埋められ、しかもすべてが正解であれば「おめでとう」というメッセージとともに得点が通知されます。</p>
      <p>　ゲームを一度でもクリアするとこれまでのスコア表が出現します。</p>
      <p>　スコア表はこれまでのベスト１０までのハイスコアで、その下に、今あなたがプレイした結果を追加で表示します。順位の更新は「RELOAD」で行えます。同じ問題を何度もプレイしたとき採用されるのは最初の得点だけです。</p>
      <h4>■ 新しいゲーム</h4>
      <p>　ゲームをクリアした後に新しい問題を始めたいときはタイトル部分（その時は得点が表示されています）をクリックしてください。</p>
      <p>　プログラムはあなたがプレイしている間に次の問題を計算し用意しているので、新しいゲームがすぐに始まります。メモリやＣＰＵが貧弱なスマホの場合 <a href="/">このページをID無しでリロード</a> するより効率的です。</p>
      <p style="text-align:center;font-weight:bold"><a href="https://github.com/hoeg1/81place" target="_blank" rel="noopener noreferrer">source code</a></p>
    </div>
  </body>
</html>

